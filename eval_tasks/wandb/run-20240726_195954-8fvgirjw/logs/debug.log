2024-07-26 19:59:54,278 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Current SDK version is 0.16.0
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Configure stats pid to 3114
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Loading settings from /home/ubuntu/.config/wandb/settings
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Loading settings from /home/ubuntu/evo-merge/eval_tasks/wandb/settings
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'api_key': '***REDACTED***', 'entity': 'mssfj-1'}
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'eval_tasks/run_jmtbench_eval.py', 'program_abspath': '/home/ubuntu/evo-merge/eval_tasks/run_jmtbench_eval.py', 'program': '/home/ubuntu/evo-merge/eval_tasks/run_jmtbench_eval.py'}
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:_log_setup():524] Logging user logs to /home/ubuntu/evo-merge/eval_tasks/wandb/run-20240726_195954-8fvgirjw/logs/debug.log
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:_log_setup():525] Logging internal logs to /home/ubuntu/evo-merge/eval_tasks/wandb/run-20240726_195954-8fvgirjw/logs/debug-internal.log
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:init():564] calling init triggers
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:init():571] wandb.init called with sweep_config: {}
config: {'wandb': {'log': True, 'entity': 'mssfj-1', 'project': 'llmeval', 'run_name': 'swallow-ms-7b-chatmath-merge-gpt4o'}, 'github_version': 'v2.0.0', 'testmode': False, 'api': False, 'model': {'use_wandb_artifacts': False, 'artifacts_path': '', 'pretrained_model_name_or_path': 'tokyotech-llm/Swallow-MS-7b-instruct-v0.1', 'trust_remote_code': True, 'device_map': 'auto', 'load_in_8bit': False, 'load_in_4bit': False}, 'generator': {'do_sample': False, 'num_beams': 1, 'top_p': 1.0, 'top_k': 0, 'temperature': 0.1, 'repetition_penalty': 1.0}, 'tokenizer': {'use_wandb_artifacts': False, 'artifacts_path': '', 'pretrained_model_name_or_path': 'tokyotech-llm/Swallow-MS-7b-instruct-v0.1', 'use_fast': False}, 'max_seq_length': 2048, 'dataset_artifact': 'wandb-japan/llm-leaderboard/jaster:v11', 'dataset_dir': '/jaster/1.2.6/evaluation/test', 'target_dataset': 'all', 'log_dir': './logs', 'torch_dtype': 'bf16', 'custom_prompt_template': None, 'custom_fewshots_template': None, 'metainfo': {'basemodel_name': 'swallow-ms-7b-chatmath-gpt4o', 'model_type': 'open llm', 'instruction_tuning_method': 'None', 'instruction_tuning_data': ['None'], 'num_few_shots': 0, 'llm-jp-eval-version': '1.1.0'}, 'mtbench': {'question_artifacts_path': 'wandb-japan/llm-leaderboard/mtbench_ja_question:v0', 'referenceanswer_artifacts_path': 'wandb-japan/llm-leaderboard/mtbench_ja_referenceanswer:v0', 'judge_prompt_artifacts_path': 'wandb-japan/llm-leaderboard/mtbench_ja_prompt:v1', 'bench_name': 'japanese_mt_bench', 'model_id': None, 'question_begin': None, 'question_end': None, 'max_new_token': 1024, 'num_choices': 1, 'num_gpus_per_model': 1, 'num_gpus_total': 1, 'max_gpu_memory': None, 'dtype': 'bfloat16', 'judge_model': 'gpt-4o-2024-05-13', 'mode': 'single', 'baseline_model': None, 'parallel': 1, 'first_n': None, 'custom_conv_template': True, 'conv_name': 'custom', 'conv_system_template': '{system_message}', 'conv_system_message': '以下は、タスクを説明する指示と、文脈のある入力の組み合わせです。要求を適切に満たす応答を書きなさい。', 'conv_roles': "('指示', '応答')", 'conv_sep': '\n\n### ', 'conv_sep2': '', 'conv_stop_token_ids': '[2]', 'conv_stop_str': '###', 'conv_sep_style': 'custom', 'conv_role_message_separator': ':\n', 'conv_role_only_separator': ':\n'}}
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:init():614] starting backend
2024-07-26 19:59:54,279 INFO    MainThread:3114 [wandb_init.py:init():618] setting up manager
2024-07-26 19:59:54,281 INFO    MainThread:3114 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-07-26 19:59:54,282 INFO    MainThread:3114 [wandb_init.py:init():624] backend started and connected
2024-07-26 19:59:54,288 INFO    MainThread:3114 [wandb_init.py:init():716] updated telemetry
2024-07-26 19:59:54,292 INFO    MainThread:3114 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-07-26 19:59:54,664 INFO    MainThread:3114 [wandb_run.py:_on_init():2254] communicating current version
2024-07-26 19:59:54,682 INFO    MainThread:3114 [wandb_run.py:_on_init():2263] got version response upgrade_message: "wandb version 0.17.5 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-07-26 19:59:54,682 INFO    MainThread:3114 [wandb_init.py:init():800] starting run threads in backend
2024-07-26 19:59:58,493 INFO    MainThread:3114 [wandb_run.py:_console_start():2233] atexit reg
2024-07-26 19:59:58,493 INFO    MainThread:3114 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2024-07-26 19:59:58,493 INFO    MainThread:3114 [wandb_run.py:_redirect():2153] Wrapping output streams.
2024-07-26 19:59:58,493 INFO    MainThread:3114 [wandb_run.py:_redirect():2178] Redirects installed.
2024-07-26 19:59:58,494 INFO    MainThread:3114 [wandb_init.py:init():841] run started, returning control to user process
2024-07-26 20:00:41,955 WARNING MsgRouterThr:3114 [router.py:message_loop():77] message_loop has been closed
